{% extends 'login/base.html' %}
{% block title %}GS各项目数据统计{% endblock %}

{% block navbar %}
    {% if request.session.is_login %}
        <ul class="nav navbar-nav">
            <li class="active"><a href="/index?name={{ request.session.user_name }}">首页</a></li>
        </ul>
    {% endif %}
{% endblock %}
{% block content %}
    {% if request.session.is_login %}
        <div id="picture" style="background-color: #bdbdbd; margin-top: -15px;">
            <div id="search">
                <form class='form-register' action="/gsdata_count/" method="post">
                    {% csrf_token %}
                    <table class="table">
                        <tr>
                            <th>开始时间</th>
                            <th>结束时间</th>
                            <th colspan="2" style="text-align: center;">按钮</th>
                        </tr>
                        <tr>
                            <td><input type="date" name="btime" id="btime" class="form-control" value="{{ btime }}"></td>
                            <td><input type="date" name="otime" id="otime" class="form-control" value="{{ otime }}"></td>
                            <td><input type="reset" class="btn btn-default pull-left" value="重置"></td>
                            <td><input type="submit" class="btn btn-primary pull-right" value="查看"></td>
                        </tr>
                    </table>
                </form>
            </div>
            <div style="float: left; position: fixed; width: 50%; height: 83.4%; overflow-y: scroll; background-color: #bdbdbd; margin-top: -20px;">
                <table class="table">
                    <tr>
                        <th>项目名字</th>
                        <th>图片/视频数量</th>
                        <th>框数/属性/时长</th>
                    </tr>
                    {% for i in tj %} <!-- 本周工作量 -->
                    <tr>
                        <td>{{ i.0 }}</td>
                        <td>{{ i.1 }}</td>
                        <td>{{ i.2 }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
            <div id="main" style="float: right; position: fixed; width: 50%;height:83.4%; margin-left: 50px; margin-top: -20px; overflow-x: scroll; background-color: #bdbdbd;"></div>
        </div>
    {% else %}
        <h3>你尚未登录,请先登录！</h3>
    {% endif %}
    <script type="text/javascript">
        var pname = JSON.parse('{{ pname_list_json|safe }}'); // 项目名字 列表
        console.log(pname);
        var pnums = JSON.parse('{{ pnums_list_json|safe }}'); // 项目名字 列表
        var knums = JSON.parse('{{ knums_list_json|safe }}'); // 项目名字 列表
        console.log(knums);
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));
        // 指定图表的配置项和数据
        var option = {title: {text: 'GS各项目数据统计图'},tooltip: {},legend: {data:['图片/视频数量','框数/属性/时长'],right:'25%',},xAxis: {data: pname},yAxis: {},
        series: [
                    {
                        name: '图片/视频数量',
                        type: 'bar',
                        stack:'图片数',
                        data: pnums,
                        itemStyle:{
                            normal:{
                                label:{
                                    show:true, //开启显示
                                    position:'top', //在上方显示
                                    textStyle:{ //数值样式
                                        color:'black',
                                        fontSize:12
                                    }
                                }
                            }
                        },
                    },
                    {
                        name: '框数/属性/时长',
                        type: 'bar',
                        stack:'框数',
                        data: knums,
                        itemStyle:{
                            normal:{
                                label:{
                                    show:true, //开启显示
                                    position:'top', //在上方显示
                                    textStyle:{ //数值样式
                                        color:'black',
                                        fontSize:12
                                    }
                                }
                            }
                        },
                    },
                ]
        }   ;
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
{% endblock %}