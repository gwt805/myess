{% extends 'login/base.html' %}
{% block title %}数据修改{% endblock %}

{% block content %}
    <form class='form-register' action="/update/" method="post">
        {% if message %}
        <div class="alert alert-warning" id="warning">{{ message }}</div>
        {% endif %}
            {% csrf_token %}
        <table class="table">
            <tr>
                <th>ID</th>
                <th>用户名</th>
                <th>项目名字</th>
                <th>是否外包</th>
                <th>任务ID</th>
                <th>日期</th>
                <th>任务类型</th>
                <th>图片数量</th>
                <th>框数</th>
                <th>工时</th>
                <th style="text-align: center;">按钮</th>
            </tr>
            <tr>
                <td><input type="text" name="id" id="id" value="{{ stu.0.id }}" class="form-control" readonly="readonly"></td>
                <td>
                    <input type="text" name="uname" id="uname" value="{{ stu.0.uname }}" class="form-control" readonly="readonly">
                </td>
                <td>
                    <select class="form-control" name="pname" id="pname">
                        <option value="{{ stu.0.pname }}">{{ stu.0.pname }}</option>
                    </select>
                </td>
                <td>
                    <select class="form-control" name="waibao" id="waibao">
                        <option value="{{ stu.0.waibao }}">{{ stu.0.waibao }}</option>
                    </select>
                </td>
                <td>
                    <input type="text" name="task_id" class="form-control" value="{{ stu.0.task_id }}">
                </td>
                <td><input type="date" name="dtime" class="form-control" id="riqi" value="{{ stu.0.dtime }}"></td>
                <td>
                    <select class="form-control" name="kinds" id="kinds">
                        <option value="{{ stu.0.kinds }}">{{ stu.0.kinds }}</option>
                    </select>
                </td>
                <td><input type="text" name="pnums" class="form-control" value="{{ stu.0.pnums }}"></td>
                <td><input type="text" name="knums" class="form-control" value="{{ stu.0.knums }}"></td>
                <td><input type="text" name="ptimes" class="form-control" required='required' value="{{ stu.0.ptimes }}"></td>
                <td>
                    <input type="submit" class="btn btn-primary pull-right" value="修改">
                </td>
            </tr>
        </table>
    </form>
    <script>
        var projects = JSON.parse('{{ projects|safe }}'); // 项目名字 列表
        var tkinds = JSON.parse('{{ tkinds|safe }}'); // 任务类型 列表

        // 给是否外包赋值
        var wb_list = ['是','否','None'];
        var wb_s = document.getElementById("waibao");
        for (var i=0;i<wb_list.length;i++){
            if (wb_list[i] != document.getElementById("waibao").value){
                var objOption = document.createElement("option");
                objOption.value = wb_list[i];
                objOption.text =wb_list[i];
                wb_s.add(objOption);
            };
        };

        // 给项目名字 添加下拉框
        var p_s = document.getElementById('pname');
        for (var i=0;i<projects.length;i++){
            if (projects[i] != document.getElementById("pname").value){
                var objOption = document.createElement("option");
                objOption.value = projects[i];
                objOption.text =projects[i];
                p_s.add(objOption);
            };
        };

        // 给任务类型 赋值
        var tk_s = document.getElementById('kinds');
        for (var i=0;i<tkinds.length;i++){
            if (tkinds[i] != document.getElementById("kinds").value){
                var objOption = document.createElement("option");
                objOption.value = tkinds[i];
                objOption.text =tkinds[i];
                tk_s.add(objOption);
            };
        };
    </script>
{% endblock %}